<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Vendor POS ‚Äî Bilingual + WhatsApp + Shared Images + Discount</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-storage-compat.js"></script>

  <style>
    body { background:#f8fafc; font-family:Inter, system-ui, sans-serif; }
    .big-btn{ padding:10px 14px; border-radius:10px; font-weight:600; min-height:44px; }
    .muted { color:#6b7280; }
    .small { font-size:.85rem; }
    .lang-toggle { padding:8px 10px; border-radius:8px; background:#eef2ff; cursor:pointer; font-weight:600; }
    /* toast */
    #toast { position: fixed; left:50%; transform: translateX(-50%); bottom:24px; background:#111827; color:white; padding:10px 16px; border-radius:8px; display:none; z-index:2000; box-shadow:0 6px 18px rgba(0,0,0,0.12); }
    /* modal */
    .modal-backdrop { position: fixed; inset:0; background: rgba(0,0,0,0.4); display:flex; align-items:center; justify-content:center; z-index:2000; }
    .thumb { width:48px; height:48px; object-fit:cover; border-radius:6px; }
    .big-image { max-width:100%; max-height:70vh; object-fit:contain; border-radius:8px; }
    .sharedGrid { display:grid; grid-template-columns:repeat(auto-fill,minmax(100px,1fr)); gap:8px; }
    .icon-btn { width:40px; height:40px; display:inline-flex; align-items:center; justify-content:center; border-radius:8px; background:#eef2ff; cursor:pointer; }
    .currency { font-weight:700; }
    .discount-box input, .discount-box select { padding:10px; border-radius:8px; }
  </style>
</head>
<body class="min-h-screen flex items-start justify-center p-4">

  <div id="toast"></div>

  <div id="imageSelectModal" style="display:none;" class="modal-backdrop">
    <div class="bg-white rounded-lg p-4 max-w-2xl w-full shadow overflow-auto" style="max-height:80vh;">
      <div class="flex items-center justify-between mb-3">
        <h3 class="font-semibold" data-i18n="img_modal_title">Select or Upload Image</h3>
        <div class="flex gap-2 items-center">
          <div id="refreshGalleryBtn" class="icon-btn" title="Refresh Gallery / ‡§ó‡•à‡§≤‡§∞‡•Ä ‡§§‡§æ‡§ú‡§º‡§æ ‡§ï‡§∞‡•á‡§Ç" aria-label="refresh">üîÑ</div>

          <label class="big-btn bg-sky-500 text-white cursor-pointer">
            üì∑ <span data-i18n="img_upload_button">Upload New</span>
            <input id="imgUploadInput" type="file" accept="image/*" capture="environment" style="display:none" />
          </label>
          <button id="closeImageModal" class="big-btn bg-slate-200">Close</button>
        </div>
      </div>

      <div class="mb-3">
        <div class="font-semibold mb-1" data-i18n="img_suggested">Suggested images</div>
        <div id="sharedImagesGrid" class="sharedGrid"></div>
      </div>

      <div class="mt-3">
        <div class="font-semibold mb-1" data-i18n="img_preview_local">Selected preview (local)</div>
        <div id="localImagePreviewArea" class="mt-2"></div>
      </div>

      <div class="flex gap-2 mt-4">
        <button id="selectThisImageBtn" class="flex-1 big-btn bg-emerald-500 text-white" data-i18n="select_image">Select</button>
        <button id="removeSelectedImageBtn" class="flex-1 big-btn bg-red-500 text-white" data-i18n="remove_image">Remove</button>
      </div>
    </div>
  </div>

  <div id="fullImageModal" style="display:none;" class="modal-backdrop">
    <div class="bg-white rounded-lg p-4 max-w-3xl w-full shadow text-center">
      <img id="fullImageView" class="big-image" src="" alt="Preview" />
      <div class="mt-3">
        <button id="closeFullImage" class="big-btn bg-slate-200">Close</button>
      </div>
    </div>
  </div>

  <div id="billModal" style="display:none;" class="modal-backdrop">
    <div class="bg-white rounded-lg p-4 max-w-md w-full shadow">
      <h3 class="font-semibold mb-2" id="billModalTitle">Bill</h3>
      <pre id="billPreview" class="whitespace-pre-wrap text-sm bg-slate-5 p-2 rounded max-h-64 overflow-auto"></pre>
      <div class="flex gap-2 mt-3">
        <button id="copyBillBtn" class="flex-1 big-btn bg-emerald-500 text-white">üìã Copy</button>
        <button id="closeBillBtn" class="flex-1 big-btn bg-slate-200">Close</button>
      </div>
    </div>
  </div>

  <div id="authWrap" class="w-full max-w-md bg-white rounded-xl shadow p-6">
    <h2 data-i18n="title_auth" class="text-2xl font-bold mb-3 text-center">Vendor ‚Äî Register / Login</h2>
    <input id="regShop" placeholder="" data-i18n-placeholder="ph_shop" class="w-full border rounded p-3 mb-2" />
    <input id="email" type="email" placeholder="" data-i18n-placeholder="ph_email" class="w-full border rounded p-3 mb-2" />
    <input id="password" type="password" placeholder="" data-i18n-placeholder="ph_password" class="w-full border rounded p-3 mb-3" />
    <div class="flex gap-2">
      <button id="registerBtn" class="flex-1 big-btn bg-sky-500 text-white" data-i18n="btn_register">Register</button>
      <button id="loginBtn" class="flex-1 big-btn bg-emerald-500 text-white" data-i18n="btn_login">Login</button>
    </div>
    <p class="text-xs muted mt-3" data-i18n="auth_note">Register saves Shop name. Login downloads your vendor data (if present).</p>
  </div>

  <div id="appWrap" class="hidden w-full max-w-xl">
   <header class="flex items-center justify-between mb-4">
  <div>
    <div id="shopName" class="text-lg font-bold" data-i18n="app_title">Vendor POS</div>
    
  </div>

  <button id="menuToggle" class="p-2 rounded-lg bg-slate-100 hover:bg-slate-200">
    ‚ò∞
  </button>
</header>

<div id="sideMenu"
     class="fixed top-0 right-0 w-64 h-full bg-white shadow-lg transform translate-x-full transition-transform duration-300 z-50 flex flex-col">
  <div class="p-4 border-b flex justify-between items-center">
    <h3 class="font-semibold text-lg" data-i18n="menu_title">Menu</h3>
    <button id="closeMenu" class="text-xl font-bold">√ó</button>
  </div>
  <div class="flex-1 p-4 space-y-3 overflow-auto">
    <div id="vendorInfo" class="small muted">email ‚Ä¢ uid</div>
    <div id="syncStatus" class="px-3 py-1 rounded small muted" data-i18n="sync_manual">Manual sync</div>
    <button id="pushBtn" class="w-full big-btn bg-amber-300 text-white" data-i18n="btn_push">‚¨ÜÔ∏è Push</button>
    <button id="pullBtn" class="w-full big-btn bg-sky-500 text-white" data-i18n="btn_pull">‚¨áÔ∏è Pull</button>
    <button id="langToggle" class="w-full big-btn bg-indigo-100" title="Toggle language">üåê ‡§π‡§ø‡§Ç‡§¶‡•Ä</button>
    <button id="logoutBtn" class="w-full big-btn bg-red-500 text-white" data-i18n="btn_logout">Logout</button>
  </div>
</div>


    <nav class="flex gap-2 mb-4">
      <button id="tabProducts" class="flex-1 big-btn bg-emerald-100" data-i18n="tab_products">Products</button>
      <button id="tabSales" class="flex-1 big-btn bg-slate-100" data-i18n="tab_sales">Sales</button>
      <button id="tabHistory" class="flex-1 big-btn bg-slate-100" data-i18n="tab_history">History</button>
    </nav>

    <main class="bg-white rounded-xl p-4 shadow">
      <section id="view-products">
        <h3 class="font-semibold mb-2" data-i18n="heading_add_edit">Add / Edit Product</h3>
        <div class="space-y-2">
          <input id="p_name" data-i18n-placeholder="ph_product_name" placeholder="Name (e.g., Tomato)" class="w-full border rounded p-2" />
          <div class="flex gap-2">
            <input id="p_price" type="number" data-i18n-placeholder="ph_price" placeholder="Price (‚Çπ)" class="flex-1 border rounded p-2" />
            <select id="p_unit" class="border rounded p-2 w-36" aria-label="unit">
              <option value="kg" data-i18n="unit_kg">kg</option>
              <option value="g" data-i18n="unit_g">g</option>
              <option value="piece" data-i18n="unit_piece">piece</option>
              <option value="dozen" data-i18n="unit_dozen">dozen</option>
            </select>
            <input id="p_qty" type="number" data-i18n-placeholder="ph_qty" placeholder="Qty (opt)" class="w-28 border rounded p-2" />
          </div>

          <div class="flex items-center gap-2">
            <button id="openImageSelector" class="big-btn bg-sky-500 text-white">üì∑ <span data-i18n="btn_image">Add / Select Image</span></button>
            <div id="selectedThumbArea"></div>
          </div>

          <div class="flex gap-2 mt-2">
            <button id="productVoiceBtn" class="big-btn bg-indigo-500 text-white mr-2">üé§ Voice Add (Prod) / ‡§µ‡•â‡§á‡§∏ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</button>
            <button id="saveProduct" class="flex-1 big-btn bg-emerald-500 text-white" data-i18n="btn_save">Save</button>
            <button id="clearProduct" class="flex-1 big-btn bg-slate-200" data-i18n="btn_clear">Clear</button>
          </div>
        </div>
        <hr class="my-3" />
        <h4 class="font-semibold mb-2" data-i18n="heading_products">Products</h4>
        <div id="productList" class="space-y-2 max-h-64 overflow-auto"></div>
      </section>

      <section id="view-sales" class="hidden">
        <h3 class="font-semibold mb-2" data-i18n="heading_record_sale">Record Sale</h3>
        <input id="saleSearch" data-i18n-placeholder="ph_search" placeholder="Type first letters to search" class="w-full border rounded p-2 mb-2" />
        <select id="sale_product" class="w-full border rounded p-2 mb-2"></select>
        <div class="flex gap-2">
          <div class="flex gap-2 items-center">
            <input id="sale_qty" type="number" min="0" placeholder="Enter quantity" class="border rounded p-2 w-full" />
            <select id="sale_unit_box" class="border rounded p-2">
              <option value="piece">Piece</option>
              <option value="dozen">Dozen</option>
              <option value="kg">Kg</option>
              <option value="g">Gram</option>
            </select>
          </div>
        </div>

        <div class="mt-3 mb-2">
          <input id="custNumber" type="tel" placeholder="Customer WhatsApp number (optional) / ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§®‡§Ç‡§¨‡§∞ (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)" class="w-full border rounded p-2" />
        </div>

        <div class="flex gap-2 mt-3">
          <button id="saleVoiceBtn" class="flex-1 big-btn bg-indigo-500 text-white">üé§ Voice Add (Sale) / ‡§µ‡•â‡§á‡§∏ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</button>
          <button id="addToCart" class="flex-1 big-btn bg-amber-400 text-white" data-i18n="btn_add_cart">Add to Cart</button>
          </div>
        <hr class="my-3" />
        <h4 class="font-semibold" data-i18n="heading_cart">Cart</h4>
        <div id="quickCart" class="space-y-2 max-h-56 overflow-auto"></div>

        <div class="discount-box mt-3 flex items-center gap-2">
          <input id="discountValue" type="number" min="0" placeholder="Discount" class="flex-1 border rounded p-2" />
          <select id="discountType" class="border rounded p-2 w-28">
            <option value="‚Çπ">‚Çπ</option>
            <option value="%">%</option>
          </select>
          <div id="grandTotalBox" class="text-right font-semibold mt-1 text-emerald-700 w-44"></div>
        </div>

        <div class="mt-3">
          <button id="checkoutBtn" class="w-full big-btn bg-emerald-600 text-white" data-i18n="btn_checkout">Checkout</button>
        </div>

        <div id="sendBillArea" class="mt-3" style="display:none;">
          <button id="sendBillBtn" class="w-full big-btn bg-emerald-700 text-white">üì± Send Bill / ‡§¨‡§ø‡§≤ ‡§≠‡•á‡§ú‡•á‡§Ç</button>
        </div>
      </section>

      <section id="view-history" class="hidden">
        <div class="flex items-center justify-between">
          <h3 class="font-semibold mb-2" data-i18n="heading_history">Sales History</h3>
          <div class="flex gap-2 items-center">
            <div class="small muted mr-2" data-i18n="lbl_filter">Filter</div>
            <select id="historyFilter" class="border rounded p-2 small">
              <option value="all" data-i18n="filter_all">All</option>
              <option value="today" data-i18n="filter_today">Today</option>
              <option value="yesterday" data-i18n="filter_yesterday">Yesterday</option>
              <option value="week" data-i18n="filter_week">This Week</option>
              <option value="month" data-i18n="filter_month">This Month</option>
            </select>
          </div>
        </div>

        <div id="historyList" class="space-y-2 max-h-72 overflow-auto"></div>
      </section>

    </main>
  </div>
 <script src="function.js"></script>

</body>
</html>