<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vendor MVP - Fruits & Vegetables</title>
<style>
  body {font-family:sans-serif;background:#f2f7f3;margin:0;}
  header {background:#4CAF50;color:#fff;text-align:center;padding:10px;font-size:1.3em;}
  .tab {display:flex;justify-content:space-around;background:#ddd;}
  .tab button {flex:1;padding:12px;font-size:1em;border:none;background:#ddd;}
  .tab button.active {background:#4CAF50;color:white;}
  section {display:none;padding:15px;}
  section.active {display:block;}
  input,select,button {padding:10px;margin:5px 0;width:100%;font-size:1em;box-sizing:border-box;}
  table {width:100%;border-collapse:collapse;margin-top:10px;}
  th,td {border:1px solid #ccc;padding:8px;text-align:left;}
  th {background:#eee;}
  .actions button {width:48%;padding:8px;margin:2px 1%;font-size:0.9em;}
  .audio-btn {background:#007bff;color:white;border:none;}
  .cart-table td,.cart-table th{text-align:center;}
  .danger{background:#f44336;color:#fff;border:none;padding:8px;border-radius:5px;}
</style>
</head>
<body>

<header>üçé Vendor App (Offline MVP)</header>

<div class="tab">
  <button id="productTab" class="active" onclick="openTab('products')">Products</button>
  <button id="saleTab" onclick="openTab('sales')">Sales</button>
  <button id="historyTab" onclick="openTab('history')">History</button>
</div>

<!-- PRODUCTS TAB -->
<section id="products" class="active">
  <h2>Add / Manage Products</h2>
  <input id="productName" placeholder="Product name">
  <input id="productPrice" type="number" placeholder="Price (‚Çπ)">
  <input id="productQty" type="number" placeholder="Quantity (optional)">
  <select id="productUnit">
    <option value="kg">Kg</option>
    <option value="g">Gram</option>
    <option value="piece">Piece</option>
    <option value="dozen">Dozen</option>
  </select>
  <button onclick="addOrUpdateProduct()">Save Product</button>
  <button class="audio-btn" onclick="startVoiceInput('productName')">üé§ Speak Product</button>

  <table>
    <thead><tr><th>Product</th><th>Price</th><th>Qty</th><th>Unit</th><th>Actions</th></tr></thead>
    <tbody id="productList"></tbody>
  </table>
</section>

<!-- SALES TAB -->
<section id="sales">
  <h2>Record Sale</h2>
  <select id="saleProduct"></select>
  <input id="saleQty" type="number" placeholder="Quantity">
  <button onclick="addToCart()">üõí Add to Cart</button>

  <h3>üßæ Cart</h3>
  <table class="cart-table">
    <thead><tr><th>Product</th><th>Qty</th><th>Price</th><th>Total</th><th>‚ùå</th></tr></thead>
    <tbody id="cartList"></tbody>
  </table>
  <h3>Total: ‚Çπ<span id="cartTotal">0</span></h3>
  <button onclick="checkout()">‚úÖ Checkout</button>
</section>

<!-- HISTORY TAB -->
<section id="history">
  <h2>üìú Sales History</h2>
  <table>
    <thead><tr><th>Date</th><th>Product</th><th>Qty</th><th>Total ‚Çπ</th></tr></thead>
    <tbody id="historyList"></tbody>
  </table>
  <button class="danger" onclick="clearHistory()">üßπ Clear All History</button>
</section>

<script>
  let products = JSON.parse(localStorage.getItem('products')) || [];
  let sales = JSON.parse(localStorage.getItem('sales')) || [];
  let cart = [];
  let editIndex = null;

  function saveData(){localStorage.setItem('products',JSON.stringify(products));localStorage.setItem('sales',JSON.stringify(sales));}
  function openTab(tab){document.querySelectorAll('section').forEach(s=>s.classList.remove('active'));
    document.querySelectorAll('.tab button').forEach(b=>b.classList.remove('active'));
    document.getElementById(tab).classList.add('active');document.getElementById(tab+'Tab').classList.add('active');
    if(tab==='sales')updateSalesDropdown();if(tab==='history')renderHistory();}
  function addOrUpdateProduct(){
    const n=document.getElementById('productName').value.trim();
    const p=parseFloat(document.getElementById('productPrice').value);
    const q=document.getElementById('productQty').value||'';
    const u=document.getElementById('productUnit').value;
    if(!n||isNaN(p))return alert('Enter product name and price');
    if(editIndex!==null){products[editIndex]={name:n,price:p,qty:q,unit:u};editIndex=null;}
    else{products.push({name:n,price:p,qty:q,unit:u});}
    saveData();renderProducts();updateSalesDropdown();clearForm();}
  function clearForm(){document.getElementById('productName').value='';document.getElementById('productPrice').value='';document.getElementById('productQty').value='';}
  function renderProducts(){const tb=document.getElementById('productList');tb.innerHTML='';
    products.forEach((p,i)=>{tb.innerHTML+=`<tr><td>${p.name}</td><td>‚Çπ${p.price}</td><td>${p.qty||'-'}</td><td>${p.unit}</td>
      <td class='actions'><button onclick='editProduct(${i})'>‚úèÔ∏è</button><button onclick='deleteProduct(${i})'>üóë</button></td></tr>`;});}
  function editProduct(i){const p=products[i];document.getElementById('productName').value=p.name;
    document.getElementById('productPrice').value=p.price;document.getElementById('productQty').value=p.qty;document.getElementById('productUnit').value=p.unit;editIndex=i;}
  function deleteProduct(i){if(confirm('Delete this product?')){products.splice(i,1);saveData();renderProducts();updateSalesDropdown();}}
  function updateSalesDropdown(){const sel=document.getElementById('saleProduct');sel.innerHTML='<option value="">Select Product</option>';
    products.forEach(p=>{sel.innerHTML+=`<option value="${p.name}">${p.name} (‚Çπ${p.price}/${p.unit})</option>`;});}
  function addToCart(){const n=document.getElementById('saleProduct').value;const q=parseFloat(document.getElementById('saleQty').value);
    if(!n||isNaN(q))return alert('Select product and quantity');const pr=products.find(p=>p.name===n);
    const t=q*pr.price;cart.push({name:n,qty:q,price:pr.price,total:t});renderCart();document.getElementById('saleQty').value='';}
  function renderCart(){const tb=document.getElementById('cartList');tb.innerHTML='';let sum=0;
    cart.forEach((c,i)=>{sum+=c.total;tb.innerHTML+=`<tr><td>${c.name}</td><td>${c.qty}</td><td>‚Çπ${c.price}</td><td>‚Çπ${c.total}</td><td><button onclick='removeCart(${i})'>‚ùå</button></td></tr>`;});
    document.getElementById('cartTotal').innerText=sum.toFixed(2);}
  function removeCart(i){cart.splice(i,1);renderCart();}
  function checkout(){if(cart.length===0)return alert('Cart empty');const d=new Date().toLocaleDateString();
    cart.forEach(c=>sales.push({...c,date:d}));cart=[];saveData();renderCart();alert('‚úÖ Sale recorded!');}
  function renderHistory(){const tb=document.getElementById('historyList');tb.innerHTML='';
    sales.forEach(s=>{tb.innerHTML+=`<tr><td>${s.date}</td><td>${s.name}</td><td>${s.qty}</td><td>‚Çπ${s.total}</td></tr>`;});}
  function clearHistory(){if(confirm('Clear all history?')){sales=[];saveData();renderHistory();}}
  function startVoiceInput(id){if(!('webkitSpeechRecognition'in window))return alert('Voice input not supported');
    const r=new webkitSpeechRecognition();r.lang='en-IN';r.start();r.onresult=e=>{document.getElementById(id).value=e.results[0][0].transcript;};}
  renderProducts();updateSalesDropdown();renderHistory();
</script>
</body>
</html>
